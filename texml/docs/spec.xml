<doc id="texml.spec">
	<title>TeXML specification</title>
	<p>TeXML is an XML vocabulary for TeX. A processor translates TeXML source into TeX.</p>

	<sect>
		<title>Root element</title>
		<p>The root element of a TeXML document is the element <e>TeXML</e>.</p>
		<p>A basic template of a TeXML document:</p>
<lst><![CDATA[<?xml version="1.0" encoding="..."?>
<TeXML>
  ... your content here ...
</TeXML>
]]></lst>
	</sect>

	<sect>
		<title>Text translation</title>
		<p>Characters are processed as follows:</p>
		<ul>
			<li>If a character has a special meaning for TeX, then the character is translated according to the table below.</li>
			<li>If the character belongs to an output encoding, then the character is printed as-is.</li>
			<li>If the character exists in a LaTeX mapping table, then a corresponding substitution for the character is used.</li>
			<li>The character is dumped as a string <tt>&amp;#xNN...NN;</tt> where <tt>NNNN</tt> is a hexadecimal code of the character.</li>
		</ul>
		<table border="1">
			<caption>Mapping of special symbols</caption>
			<tr>
				<th>symbol</th>
				<th>text mode</th>
				<th>math mode</th>
			</tr>
			<tr>
				<td>\</td>
				<td>$\backslash$</td>
				<td>\backslash </td>
			</tr>
			<tr>
				<td>{</td>
				<td>\{</td>
				<td>\{</td>
			</tr>
			<tr>
				<td>}</td>
				<td>\}</td>
				<td>\}</td>
			</tr>
			<tr>
				<td>$</td>
				<td>\$</td>
				<td>\$</td>
			</tr>
			<tr>
				<td>&amp;</td>
				<td>\&amp;</td>
				<td>\&amp;</td>
			</tr>
			<tr>
				<td>#</td>
				<td>\#</td>
				<td>\#</td>
			</tr>
			<tr>
				<td>^</td>
				<td>\^{}</td>
				<td>\^{}</td>
			</tr>
			<tr>
				<td>_</td>
				<td>\_</td>
				<td>\_</td>
			</tr>
			<tr>
				<td>~</td>
				<td>\~{}</td>
				<td>\~{}</td>
			</tr>
			<tr>
				<td>%</td>
				<td>\%</td>
				<td>\%</td>
			</tr>
			<tr>
				<td>|</td>
				<td>$|$</td>
				<td>|</td>
			</tr>
			<tr>
				<td>&lt;</td>
				<td>$&lt;$</td>
				<td>&lt;</td>
			</tr>
			<tr>
				<td>&gt;</td>
				<td>$&gt;$</td>
				<td>&gt;</td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
			</tr>
		</table>
		<p>LaTeX mapping table is automatically generated from the file <a href="http://www.w3.org/Math/characters/unicode.xml">unicode.xml</a>. This file is an appendix for the W3C MathML specification.</p>
		<p>Empty lines also have a special meaning for TeX. They cause automatic generation of the TeX command <tt>\par</tt>. In order to avoid it, processor instead of a empty line prints a line with the one symbol <tt>%</tt> (TeX comment).</p>
	</sect>

	<sect>
		<title>Switching between modes</title>
		<a name="mode"/><p>There are two modes: <tt>text</tt> and <tt>math</tt>.</p>
		<p>Modes affect only translation of text.</p>
		<p>Default mode is the <tt>text</tt> mode. In order to change mode, use attribute <e>mode</e> of the element <e>TeXML</e>. Possible values of this attribute are <tt>math</tt> and <tt>text</tt>. If element <e>TeXML</e> is used without attribute <e>mode</e>, then mode is not changed.</p>
		<lst><![CDATA[<?xml version="1.0" encoding="..."?>
<TeXML>
  ... text mode here ...
  <TeXML mode="math">
    ... math mode here ...
  </TeXML>
</TeXML>
]]></lst>
		<p>Elements <e><a href="#math">math</a></e> and <e><a href="#dmath">dmath</a></e> also change mode to <tt>math</tt>. These elements are described below.</p>
	</sect>

	<sect>
		<title>Encoding commands</title>
		<p>The TeXML <e>cmd</e> element encodes TeX commands.</p>
		<ul>
			<li>To write a command with no parameters, such as <tt>\par</tt>, write <code>&lt;cmd name="par"/&gt;</code>.</li>
			<li>To add parameters to a command, add <e>parm</e> children to the <e>cmd</e> element. The processor places <e>parm</e> children within TeX groups, that is, curly braces.</li>
			<li>To add options to a command, add <e>opt</e> children to the <e>cmd</e> element. The processor places <e>opt</e> children within square braces, as LaTeX style options.</li>
		</ul>
		<p>As an example, the TeX code</p>
<lst>\documentclass[12pt]{letter}</lst>
		<p>will look like this in XML:</p>
<lst><![CDATA[<cmd name="documentclass">
  <opt>12pt</opt>
  <parm>letter</parm>
</cmd>]]></lst>
	</sect>


	<sect>
		<title>Encoding environments</title>
		<p>The element <e>env</e> is a convenience for expressing LaTeX environments. In order to get</p>
<lst>\begin{document}
  ...
\end{document}</lst>
		<p>write in TeXML:</p>
<lst>&lt;env name="document"&gt;
  ...
&lt;/env&gt;</lst>
		<p>By default processor uses command <tt>begin</tt> to start the environment and uses command <tt>end</tt> to finish the environment. If you have another conventions for the environment block, you can specify commands for starting and finishing the environment in attributes <e>begin</e> and <e>end</e> of the element <e>env</e>.</p>
	</sect>


	<sect>
		<title>Encoding groups</title>
		<p>The <e>group</e> element is a convenience for encoding groups. The processor will supply an open brace at the beginning, and a close brace at the end of the group. The TeX scrap, <code>{\it italics}</code> may appear as</p>
		<lst><![CDATA[<group><cmd name="it"/>italics</group>]]></lst>
		<p>in TeXML.</p>
		<p>Elements <a name="math"/><e>math</e> and <a name="dmath"/><e>dmath</e> are conveniences for encoding math groups. The processor writes appropriate math shift symbol at the beginning and at the end of the group and also switches <a href="#mode">mode</a> to <tt>math</tt> inside the group. The TeXML code</p>
<lst><![CDATA[<math>a+b</math>
<dmath><cmd name="sqrt"/>2</dmath>]]></lst>
		<p>translates to the following TeX code:</p>
<lst>$a+b$
$$\sqrt 2$$</lst>
	</sect>
</doc>
